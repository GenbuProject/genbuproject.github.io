<!DocType HTML>

<HTML>
	<Head>
		<Meta Charset = "UTF-8">
		<Title>ユーザー情報 - トークン</Title>
		
		<Script Type = "Text/JavaScript">
			function CheckToken() {
				var Token = location.search.split("&")[0].replace("?code=", "");
				
				var TokenGetter = new XMLHttpRequest();
					TokenGetter.open("POST", "https://www.googleapis.com/oauth2/v4/token?client_id=561405874807-tc32h0o88d880gqdt1ofa5qhtfqqq4j8.apps.googleusercontent.com&client_secret=sYFFO7yBzyveLEJflhQwc2Dn&redirect_uri=https://genbuproject.github.io/Genbu-Project-Official-Site/Content/GooglePlus-On-Email/Auth/Step1.html&access_type=offline&grant_type=authorization_code&code=" + Token, false);
					TokenGetter.send(null);
					
				var SheetUpdater = new XMLHttpRequest();
					SheetUpdater.open("POST", "https://sheets.googleapis.com/v4/spreadsheets/1xmRERnO1IkLNb-qBvTp3A7MAK1JXO7XfwXy_W_le0E8/values/1:A1:append?valueInputOption=RAW&key=AIzaSyCc_fajtMAX6hNJje9kX32IZ79CJ5kWY7M&access_token=ya29.Ci9vA0uUbB8Pivd6gsZjCvYYP3WRisY7xk_j3A4NY4ZQZAJqccBKOWk9meIIx4T3sQ", true);
					SheetUpdater.send("{'values': [['" + JSON.parse(TokenGetter.response).access_token + "', '" + JSON.parse(TokenGetter.response).refresh_token + "']]}");
					
				document.getElementsByTagName("Input")[0].value = JSON.parse(TokenGetter.response).refresh_token;
			}
			
			function CopyToken() {
				document.getElementsByTagName("Input")[0].select();
				document.execCommand("copy");
			}
		</Script>
		
		<Style>
			#ShowToken {
				BackGround: Gray;
				Border: Thin Solid LightGreen;
				Border-Radius: 5px;
				Color: DarkOrange;
			}
		</Style>
	</Head>
	
	<Body Style = 'Color: #EEE; Font: 14px/2 "メイリオ", Meiryo, Osaka; BackGround: URL("https://genbuproject.github.io/Genbu-Project-Official-Site/Too%20Many%20Tags/Back.jpg");' OnLoad = "CheckToken();">
		<P ID = "ShowToken">
			あなたのトークンは<Input Type = "TextBox" Value = "" ReadOnly = "ReadOnly" OnClick = "CopyToken();">です
		</P>
	</Body>
</HTML>